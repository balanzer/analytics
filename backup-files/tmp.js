
!function i(r, l, s) { function c(o, e) { if (!l[o]) { if (!r[o]) { var t = "function" == typeof require && require; if (!e && t) return t(o, !0); if (a) return a(o, !0); throw new Error("Cannot find module '" + o + "'") } var n = l[o] = { exports: {} }; r[o][0].call(n.exports, function (e) { var t = r[o][1][e]; return c(t || e) }, n, n.exports, i, r, l, s) } return l[o].exports } for (var a = "function" == typeof require && require, e = 0; e < s.length; e++)c(s[e]); return c }({ 1: [function (e, t, o) { "use strict"; var n = this; o.__esModule = !0; var i = e("../../../tests/COMMON/dist/commonLibs.min"), r = new i.PollUtil("2020-27", "B", "IHG EX HI – Pay Page –Hide Non-required Address Fields"), l = new i.TrackingMetricsUtil("2020-27", "B", "IHG EX HI – Pay Page –Hide Non-required Address Fields"), s = new i.LogUtil, c = new (a.prototype.getShouldSetExpSwitchMetric = function () { return this.shouldSetExpSwitchMetric }, a.prototype.setShouldSetExpSwitchMetric = function (e) { this.shouldSetExpSwitchMetric = e }, a.prototype.fireTrackingMetric = function (t) { r.runPoll(function () { return "object" == typeof window.s && "function" == typeof window.s.tl }, function () { try { l.sCall(t) } catch (e) { console.error("TAO - Exception on 2020-27_" + t + " tracking metric sCall: ", e), setTimeout(function () { r.runPoll(function () { return document.querySelector('[data-slnm-ihg="titleBarTitle"]') }, function () { for (var e = 0; e < 3; e++)document.querySelector('[data-slnm-ihg="titleBarTitle"]').click() }, 100, 0, function () { console.log("TAO - Poll failed for title bar") }) }, 1200) } }, 100, 0, function () { console.log("TAO - Poll failed for window.s and window.s.tl metric") }) }, a.prototype.getIsTestViewed = function () { return this.isTestViewed }, a.prototype.setIsTestViewed = function (e) { this.isTestViewed = e }, a.prototype.setExperienceSwitchingTracker = function () { r.runPoll(function () { return "object" == typeof window.s && "function" == typeof window.s.tl }, function () { try { l.setExperienceSwitchingTracker() } catch (e) { console.error("TAO - Exception on experience switching metric sCall: ", e), setTimeout(function () { r.runPoll(function () { return document.querySelector('[data-slnm-ihg="titleBarTitle"]') }, function () { for (var e = 0; e < 3; e++)document.querySelector('[data-slnm-ihg="titleBarTitle"]').click() }, 100, 0, function () { console.log("TAO - Poll failed for title bar") }) }, 1e3) } }, 100, 0, function () { console.log("TAO - Poll failed for window.s and window.s.tl metric") }) }, a.prototype.hideAndShowElements = function (e) { var t = document.querySelector(".smsContainer +.checkBoxContainer"); t && (t.style.display = e); var o = document.querySelector(".loader-wrapper-guest-pay-info"), n = document.querySelector(".form-group.phoneNumber").previousElementSibling, i = document.querySelector(".postal-control"); o && "none" === e ? (o.classList.add("non-required-guest"), n && n.classList.add("country-code")) : (o.classList.remove("non-required-guest"), n && n.classList.remove("country-code"), i && i.parentNode.removeChild(i)); var r = document.querySelector('[data-slnm-ihg="postalCodeTitle"]'); r && r.parentElement && (r.parentElement.parentElement.style.display = e, this.postalCodeOptional || (r.parentElement.parentElement.style.display = "block")); var l = document.querySelector('[data-slnm-ihg="addressOneTitle"]'); l && l.parentElement && (l.parentElement.parentElement.style.display = e); var s = document.querySelector('[data-slnm-ihg="anotherAddressLink"]'); s && s.parentElement && (s.parentElement.parentElement.style.display = e); var c = document.querySelector('[data-slnm-ihg="localitySelect"]'); c && c.parentElement && (c.parentElement.parentElement.style.display = e); var a = document.querySelector('[data-slnm-ihg="cityTitle"]'); a && a.parentElement && (a.parentElement.parentElement.style.display = e); var u = document.querySelector('[data-slnm-ihg="requiredFieldTitle"] > div:last-child'); u && (u.style.textAlign = "right") }, a.prototype.addValidationsPostal = function () { var e = document.querySelector(".postal-input"), t = document.querySelector(".postal-input-error"); e.onblur = function () { "" === e.value && (e.classList.add("invalid-postal"), t.style.display = "inline-none") }, e.onfocus = function () { this.classList.contains("invalid-postal") && (this.classList.remove("invalid-postal"), t.style.display = "none") } }, a.prototype.showPostalField = function (e) { this.postalCodeOptional = "block" === e, (document.querySelector(".postal-code-field").style.display = e) && setTimeout(this.addValidationsPostal, 1200) }, a.prototype.addMandate = function (e) { e.forEach(function (e) { var t = document.querySelector(e.ele); t.classList.contains("mandate") || (t.innerText = e.replace ? t.innerText.replace("<sup>*&#x200E;</sup>", "").trim().replace("*", "") + "*" : -1 === t.innerText.indexOf("*") ? t.innerText.trim() + "*" : t.innerText.trim(), t.classList.add("mandate")) }) }, a.prototype.epaymentEventHandle = function () { var e = document.querySelector(".payment-information-body.e-payment"); return !(!e || e.classList.contains("epaymentEventHandle") || (this.showPostalField("block"), 0)) }, a.prototype.addPaymentPageNonMemberInit = function () { var e = document.querySelector(".logIn-anonymous"), t = document.querySelector(".logIn-implicit"); if ("none" === e.style.display && "none" === t.style.display) return this.hideAndShowElements("block"), void this.addMandate([{ ele: '[data-slnm-ihg="cityTitle"] > span', replace: !0 }, { ele: '[data-slnm-ihg="postalCodeTitle"]', replace: !0 }, { ele: '[data-slnm-ihg="countryRegionLabel"]', replace: !1 }, { ele: '[data-slnm-ihg="addressOneTitle"]', replace: !1 }, { ele: '[data-slnm-ihg="countryTitle"]', replace: !1 }, { ele: '[data-slnm-ihg="localityTitle"]', replace: !1 }]); this.addMandate([{ ele: '[data-slnm-ihg="countryRegionLabel"]', replace: !1 }, { ele: '[data-slnm-ihg="countryTitle"]', replace: !1 }, { ele: '[data-slnm-ihg="postalCodeTitle"]', replace: !0 }]), this.hideAndShowElements("none"); var o = this.epaymentEventHandle(), n = document.querySelector(".postal-control"), i = document.querySelector(".expYearField"); n && document.querySelector(".expYearField").parentElement.contains(n) || o || (i.parentElement.insertAdjacentHTML("beforeend", '<div class="formItem col-xs-6 no-right-padding form-element col-lg-3 postal-control">\n        <label class="payment-form-label field-label hSeven pTwo"  for="">Billing Zip/Postal Code*</label>\n        <div class="btn-group "><input type="text" class="form-control pOne postal-input" /><p class="inline-error-message postal-input-error pTen large-viewport error-inline" style="display:none">Enter Billing Zip/Postal Code.</p></div>\n        </div>'), this.addValidationsPostal()) }, a.prototype.triggerExplicitLoginMetric = function () { var e = this; r.runPoll(function () { return angular && angular.element && angular.element(document.querySelector('a[data-uhf-rememberme="cookie"]')) && angular.element(document.querySelector('a[data-uhf-rememberme="cookie"]')).scope() && angular.element(document.querySelector('a[data-uhf-rememberme="cookie"]')).scope().currentEnrollStatus }, function () { "EXPLICIT" != angular.element(document.querySelector('a[data-uhf-rememberme="cookie"]')).scope().currentEnrollStatus || e.hasLoginFired || (e.fireTrackingMetric("explicitLogin"), e.hasLoginFired = !0) }, 100, 0, function () { console.log("TAO - Poll failed for explicit login metric") }) }, a); function a() { this.postalCodeOptional = !0, this.TEST_ID = "2020-27", this.TEST_NAME = "IHG EX HI – Pay Page –Hide Non-required Address Fields", this.TEST_EXPERIENCE = "B", this.isTestViewed = !1, this.shouldSetExpSwitchMetric = !1, this.hasLoginFired = !1 } r.runPoll(function () { return document.querySelector(".guestForm") && document.querySelector('[data-slnm-ihg="cityField"]') }, function () { console.log("TAO - Poll success"); try { setTimeout(function () { console.log(s.testStart("2020-27", "B")), window.mvtGIPIEnabled = !0, window.mvtParams = { countryOptional: !0, addressOptional: !0, cityOptional: !0, postalCodeOptional: !n.postalCodeOptional, stateOptional: !0 }, c.addPaymentPageNonMemberInit(), c.triggerExplicitLoginMetric(), new i.MutationObserverUtil(c, [c.addPaymentPageNonMemberInit, c.triggerExplicitLoginMetric], 1e3, document.querySelector("#applicationWrapper"), { attributes: !1, childList: !0, subtree: !0 }).initTaoMutationObserver(), new i.MutationObserverUtil(c, [c.addPaymentPageNonMemberInit, c.triggerExplicitLoginMetric], 1e3, document.querySelector(".logIn"), { attributes: !0, childList: !0, subtree: !0 }).initTaoMutationObserver(), setTimeout(function () { c.setIsTestViewed(!0) }, 400), c.triggerExplicitLoginMetric(), setTimeout(function () { c.setShouldSetExpSwitchMetric(!0) }, 200) }, 2e3) } catch (e) { console.error("TAO - Exception on Test 2020-27 Exp B: ", e) } }, 100, 0, function () { console.log("TAO - Poll failed for experience") }), r.runPoll(function () { return c.getShouldSetExpSwitchMetric() && "object" == typeof window.s && "function" == typeof window.s.tl }, function () { c.setExperienceSwitchingTracker() }, 100, 0, function () { console.log("TAO - Poll failed for setting experience switching metric") }), r.runPoll(function () { return c.getIsTestViewed() && "object" == typeof window.s && "function" == typeof window.s.tl }, function () { c.fireTrackingMetric("testViewed") }, 100, 0, function () { console.log("TAO - Poll failed for testViewed metric") }) }, { "../../../tests/COMMON/dist/commonLibs.min": 4 }], 2: [function (e, t, o) { "use strict"; o.__esModule = !0; var n = (i.prototype.insertAfter = function (e, t) { e.parentNode.insertBefore(t, e.nextSibling) }, i.prototype.prepend = function (e, t) { e.parentNode.insertBefore(t, e) }, i.prototype.nodeListToArray = function (e) { return Array.prototype.slice.call(e) }, i.prototype.debounce = function (n, i, r) { var l; return function () { var e = this, t = arguments, o = r && !l; clearTimeout(l), l = setTimeout(function () { l = null, r || n.apply(e, t) }, i), o && n.apply(e, t) } }, i); function i() { } o.CommonMethodsUtil = n }, {}], 3: [function (e, t, o) { "use strict"; o.__esModule = !0; var n = (i.prototype.runPoll = function (e, t, o, n, i) { var r = this; void 0 === o && (o = this.duration), o = o || 50, n = n || 0, i = i || function () { console.log("TAO." + r.TEST_ID + "." + r.TEST_EXP + " - Tao - Poll timed out") }, e() ? t() : 100 < n ? i() : (n++, setTimeout(function () { r.runPoll(e, t, o, n, i) }, o)) }, i); function i(e, t, o, n) { this.TEST_ID = e, this.TEST_EXP = t, this.TEST_NAME = o, this.duration = n } o.PollUtil = n }, {}], 4: [function (e, t, o) { "use strict"; o.__esModule = !0; var n = (i.prototype.insertAfter = function (e, t) { e.parentNode.insertBefore(t, e.nextSibling) }, i.prototype.prepend = function (e, t) { e.parentNode.insertBefore(t, e) }, i.prototype.nodeListToArray = function (e) { return Array.prototype.slice.call(e) }, i.prototype.debounce = function (n, i, r) { var l; return function () { var e = this, t = arguments, o = r && !l; clearTimeout(l), l = setTimeout(function () { l = null, r || n.apply(e, t) }, i), o && n.apply(e, t) } }, i); function i() { } o.CommonMethodsUtil = n, o.__esModule = !0; var r = (l.prototype.testStart = function (e, t) { return this.MSG_PREFIX + "Beginning test " + e + " Exp " + t }, l.prototype.testError = function (e, t) { return this.MSG_PREFIX + "Exception on test " + e + " Exp " + t }, l); function l() { this.MSG_PREFIX = "TAO - " } o.LogUtil = r, o.__esModule = !0; var s = new (e("./CommonMethodsUtil").CommonMethodsUtil), c = (a.prototype.initTaoMutationObserver = function () { this.TARGET_ELEMENT.addEventListener(this.RESULTS_LOADED_EVENT_NAME, this.setDebouncedMethod().bind(this)), this.setMutationObserver() }, a.prototype.setDebouncedMethod = function () { return s.debounce(this.executeMethods, this.DURATION, !1) }, a.prototype.executeMethods = function () { for (var e = 0, t = this.TEST_METHODS; e < t.length; e++)t[e].bind(this.TEST_OBJECT)() }, a.prototype.setMutationObserver = function () { var o = this.TARGET_ELEMENT, n = this.RESULTS_LOADED_EVENT, e = this.TARGET_CONFIG; new MutationObserver(function (e, t) { o.dispatchEvent(n) }).observe(o, e) }, a); function a(e, t, o, n, i) { this.LOADING_ELEMENT = document.querySelector("div.searchResultsContainer"), this.RESULTS_LOADED_EVENT_NAME = "results_loaded", this.RESULTS_LOADED_EVENT = new Event(this.RESULTS_LOADED_EVENT_NAME), this.LOADING_CONFIG = { attributes: !1, childList: !0, subtree: !0, characterData: !1 }, this.TEST_OBJECT = e, this.TEST_METHODS = t, this.TARGET_ELEMENT = n || this.LOADING_ELEMENT, this.TARGET_CONFIG = i || this.LOADING_CONFIG, this.DURATION = o || 2e3 } o.MutationObserverUtil = c, o.__esModule = !0; var u = (d.prototype.runPoll = function (e, t, o, n, i) { var r = this; void 0 === o && (o = this.duration), o = o || 50, n = n || 0, i = i || function () { console.log("TAO." + r.TEST_ID + "." + r.TEST_EXP + " - Tao - Poll timed out") }, e() ? t() : 100 < n ? i() : (n++, setTimeout(function () { r.runPoll(e, t, o, n, i) }, o)) }, d); function d(e, t, o, n) { this.TEST_ID = e, this.TEST_EXP = t, this.TEST_NAME = o, this.duration = n } o.PollUtil = u, o.__esModule = !0; o.TimeUtil = function () { }, o.__esModule = !0; var p = e("./PollUtil"), f = (T.prototype.fireTrackingMetric = function (t, o, n) { var i = this; void 0 === o && (o = '[data-slnm-ihg="titleBarTitle"]'), void 0 === n && (n = 100); try { this.pollUtil.runPoll(function () { return "object" == typeof window.s && "function" == typeof window.s.tl }, function () { var e = i.TEST_ID + "_" + t; window.s.tl(!0, "o", e, null, null), console.log("TAO - Metric called: " + i.TEST_ID + "_" + t) }, n, 0, function () { console.log("TAO - Poll failed for window.s and window.s.tl metric") }) } catch (e) { console.error("TAO - Exception on " + this.TEST_ID + "_" + t + " tracking metric"), setTimeout(function () { i.pollUtil.runPoll(function () { return document.querySelector(o) }, function () { for (var e = 0; e < 3; e++)document.querySelector(o).click() }, n, 0, function () { console.log("TAO - Poll failed for selector: " + o) }) }, this.ERROR_CLICK_DELAY) } }, T.prototype.setExperienceSwitchingTracker = function (e) { var o = this; void 0 === e && (e = 100), this.pollUtil.runPoll(function () { return "undefined" != typeof Storage }, function () { var e = sessionStorage.getItem(o.ITEM_EXP_SWITCH), t = o.TEST_ID + "_Exp" + o.TEST_EXPERIENCE + "_experienceTracker"; e && e != t ? (console.log("TAO - Test experience switched."), o.fireTrackingMetric("testSwitched")) : (sessionStorage.setItem(o.ITEM_EXP_SWITCH, t), console.log("TAO - Test experience set.")) }, e, 0, function () { console.log("TAO - Poll failed for Storage.") }) }, T.prototype.sCall = function (e) { if ("object" == typeof window.s && "function" == typeof window.s.tl) { window.s.hasOwnProperty("events") && void 0 !== window.s.events || (window.s.events = "None"); var t = this.TEST_ID + "_" + e; window.s.tl(!0, "o", t, null, null), console.log("TAO - Metric called: " + this.TEST_ID + "_" + e) } }, T); function T(e, t, o) { this.TEST_ID = e, this.TEST_EXPERIENCE = t, this.TEST_NAME = o, this.ERROR_CLICK_DELAY = 1e3, this.ITEM_EXP_SWITCH = e + "_taoExpSwitch", this.pollUtil = new p.PollUtil(e, t, o) } o.TrackingMetricsUtil = f }, { "./CommonMethodsUtil": 2, "./PollUtil": 3 }] }, {}, [1]);
